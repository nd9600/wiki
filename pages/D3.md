[D3](https://d3js.org/) is a data visualisation library for HTML, SVGs, and CSS.

Generally, it works by:
1. [Selecting](#selections) DOM elements
2. [Joining data](#data_joins) to those elements
3. [Adding/removing](#enter_exit) elements from the page to match the data you've joined with
4. [Transforming](#transformations) the elements

Along with that, D3 also includes functions that let you easily
* [Scale](#scaling_inputs) input values to match some scale, useful when making axes
* [Make shapes](#making_shapes)
* [Layout data](#layouts) in more complicated ways
* [Interact](#interactions) with your data or elements

<sub>everything here will call functions like `d3.select()`, not `select()`</sub>

# API reference
[Here](https://github.com/d3/d3/blob/master/API.md)

Normally (but not always), D3's methods return DOM elements, so you can chain them together:
```
d3.select("#treeSvg g.tree__nodes")
    .selectAll("circle.tree__node")
    .data(root.descendants())
    .enter()
    .append("g");
```

# Selections

First, you need to `select` HTML or SVG elements on the page - D3 works with both HTML _and_ SVG - using [CSS selector syntax](https://developer.mozilla.org/en-US/docs/Glossary/CSS_Selector):
* `select` selects 1 element,
* `selectAll` selects all elements that match the selector

```
d3.select("body").style("background-color", "black");   // selects just the <body>, and makes it black
d3.selectAll(".paragraph").style("color", "blue");      // selects all .paragraph's, and makes them all have blue text
```

Normally, you'll want to join your elements with some data afterwards:

# Data joins

You then [attach/bind some data to your elements](https://github.com/d3/d3-selection/blob/v1.4.1/README.md#joining-data) after you've selected them - the data must always be an array.
For example, this selects all the circles, then sets their radiuses to be each score:
```
<circle r="40" cx="100 />
<circle r="40" cx="120" />

const scores = [
    {
        "name": "Andy",
        "score": 25
    },
    {
      "name": "Beth",
     "score": 39
    }
];

d3.selectAll('circle')
    .data(scores)
    .attr(
        'r', 
        function(d, i) {
            return d.score;
        }
    );
```
`d3.attr()` sets an attribute on each `circle`, here the radius.

The function here is called once for each element in `scores`, and implicitly passes in each `score` object, and its index - 0 to 5 here.

When D3 joins data to elements, it adds a `_data_` attribute to each DOM element with the joined data.

### Joining 1 thing
You can also join a single thing (like 1 objet by itself), with `.datum()`:
```
const featureCollection = {type: 'FeatureCollection', features: features};
d3.select('path#my-map')
    .datum(featureCollection);
```


# Enter/exit

# Transformations
See the [API reference](https://github.com/d3/d3/blob/master/API.md#modifying-elements). 
A lot of the time, you'll want to use
* `d3.attr()` to set an attribute on an element
* `d3.style()` to set a style
* `d3.classed()` to add or remove a class
* `d3.property()` to set a property, like `checked`
* `d3.text()` to set the text content 
* `d3.html()` to set the HTML content 

Each method returns the [selection](#selections) again, so you can chain them together:
```
d3.selectAll('circle')
    .data(myData)
    .attr('r', function(d, i) {
        return d;
    })
    .classed('high', function(d, i) {
        return d >= 40;
    })
    .attr('cx', function(d, i) {
     return i * 120;
    });
```

# Examples

## Simple bar chart
From [D3 in depth](https://www.d3indepth.com/datajoins/), 
```
const cities = [
  { name: 'London', population: 8674000},
  { name: 'New York', population: 8406000},
  { name: 'Sydney', population: 4293000},
  { name: 'Paris', population: 2244000},
  { name: 'Beijing', population: 11510000}
];

// Join cities to rect elements and modify height, width and position
d3.selectAll('rect')
    .data(cities)
    .attr('height', 19)
    .attr('width', function(d) {
        const scaleFactor = 0.00004;
        return d.population * scaleFactor;
    })
    .attr('y', function(d, i) {
        return i * 20;
    });

// Join cities to text elements and modify content and position
d3.selectAll('text')
    .data(cities)
    .attr('y', function(d, i) {
        return i * 20 + 13;
    })
    .attr('x', -4)
    .text(function(d) {
    return d.name;
    });
```

## Useful functions
# Scaling inputs

# Making shapes

# Layouts

# Interactions

---

Resources
[D3 in depth](https://www.d3indepth.com/introduction/)
[Interactive data visualisation for the web](https://alignedleft.com/tutorials/d3)